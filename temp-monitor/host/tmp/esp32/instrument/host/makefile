# WARNING: This file is automatically generated. Do not edit. #
INSTRUMENT = 1
MODDABLE = /home/moddable/Projects/moddable
FULLPLATFORM = esp32
PLATFORMPATH = esp32
PLATFORM = esp32
BLEMODULEPATH = /home/moddable/Projects/moddable/modules/network/ble/nimble
NAME = host
BUILD = /home/moddable/Projects/moddable/build
MODULES = /home/moddable/Projects/moddable/modules
COMMODETTO = /home/moddable/Projects/moddable/modules/commodetto
PIU = /home/moddable/Projects/moddable/modules/piu
NAMESPACE = moddable.tech
DASH_SIGNATURE = tech-moddable-host
DOT_SIGNATURE = tech.moddable.host
SLASH_SIGNATURE = /tech/moddable/host
SDKCONFIGPATH = /home/moddable/Projects/moddable/build/devices/esp32/xsProj

BIN_DIR = /home/moddable/Projects/iot-product-dev-book/temp-monitor/host/bin/esp32/instrument/host
BUILD_DIR = /home/moddable/Projects/moddable/build
DATA_DIR = /home/moddable/Projects/iot-product-dev-book/temp-monitor/host/tmp/esp32/instrument/host/resources
MAIN_DIR = /home/moddable/Projects/iot-product-dev-book/temp-monitor/host
MODULES_DIR = /home/moddable/Projects/iot-product-dev-book/temp-monitor/host/tmp/esp32/instrument/host/modules
RESOURCES_DIR = /home/moddable/Projects/iot-product-dev-book/temp-monitor/host/tmp/esp32/instrument/host/resources
TMP_DIR = /home/moddable/Projects/iot-product-dev-book/temp-monitor/host/tmp/esp32/instrument/host
XS_DIR = /home/moddable/Projects/moddable/xs

CREATION = -c 1536,512,512,64,256,37,53,3,1024,17,32768,main

MANIFEST = \
	/home/moddable/Projects/iot-product-dev-book/temp-monitor/host/manifest.json \
	/home/moddable/Projects/moddable/examples/manifest_base.json \
	/home/moddable/Projects/moddable/build/devices/esp32/manifest.json \
	/home/moddable/Projects/moddable/examples/manifest_net.json \
	/home/moddable/Projects/moddable/modules/network/mdns/manifest.json \
	/home/moddable/Projects/moddable/modules/crypt/tls.json \
	/home/moddable/Projects/moddable/modules/pins/analog/manifest.json \
	/home/moddable/Projects/moddable/modules/files/file/manifest.json
STRIPS =\
	-s "Atomics"\
	-s "BigInt"\
	-s "eval"\
	-s "Function"\
	-s "Generator"\
	-s "Map"\
	-s "Proxy"\
	-s "Reflect"\
	-s "RegExp"\
	-s "Set"\
	-s "SharedArrayBuffer"\
	-s "WeakMap"\
	-s "WeakSet"

MODULES =\
	$(MODULES_DIR)/time.xsb\
	$(MODULES_DIR)/timer.xsb\
	$(MODULES_DIR)/Resource.xsb\
	$(MODULES_DIR)/instrumentation.xsb\
	$(MODULES_DIR)/socket.xsb\
	$(MODULES_DIR)/net.xsb\
	$(MODULES_DIR)/sntp.xsb\
	$(MODULES_DIR)/wifi.xsb\
	$(MODULES_DIR)/mdns.xsb\
	$(MODULES_DIR)/dns.xsb\
	$(MODULES_DIR)/ec.xsb\
	$(MODULES_DIR)/ecp.xsb\
	$(MODULES_DIR)/modular.xsb\
	$(MODULES_DIR)/mont.xsb\
	$(MODULES_DIR)/bin.xsb\
	$(MODULES_DIR)/crypt.xsb\
	$(MODULES_DIR)/ber.xsb\
	$(MODULES_DIR)/curve.xsb\
	$(MODULES_DIR)/dsa.xsb\
	$(MODULES_DIR)/ecdsa.xsb\
	$(MODULES_DIR)/gcm.xsb\
	$(MODULES_DIR)/hmac.xsb\
	$(MODULES_DIR)/pkcs1.xsb\
	$(MODULES_DIR)/pkcs1_5.xsb\
	$(MODULES_DIR)/pkcs8.xsb\
	$(MODULES_DIR)/rng.xsb\
	$(MODULES_DIR)/rsa.xsb\
	$(MODULES_DIR)/x509.xsb\
	$(MODULES_DIR)/securesocket.xsb\
	$(MODULES_DIR)/base64.xsb\
	$(MODULES_DIR)/hex.xsb\
	$(MODULES_DIR)/file.xsb\
	$(MODULES_DIR)/main.xsb\
	$(MODULES_DIR)/loadmod.xsb\
	$(MODULES_DIR)/http.xsb\
	$(MODULES_DIR)/websocket.xsb\
	$(MODULES_DIR)/logical.xsb\
	$(MODULES_DIR)/mqtt.xsb\
	$(MODULES_DIR)/mqttserver.xsb\
	$(MODULES_DIR)/flash.xsb\
	$(MODULES_DIR)/setup/network.xsb\
	$(MODULES_DIR)/dns/parser.xsb\
	$(MODULES_DIR)/dns/serializer.xsb\
	$(MODULES_DIR)/ssl/alert.xsb\
	$(MODULES_DIR)/ssl/cache.xsb\
	$(MODULES_DIR)/ssl/cert.xsb\
	$(MODULES_DIR)/ssl/changecipher.xsb\
	$(MODULES_DIR)/ssl/ciphersuites.xsb\
	$(MODULES_DIR)/ssl/constants.xsb\
	$(MODULES_DIR)/ssl/handshake.xsb\
	$(MODULES_DIR)/ssl/prf.xsb\
	$(MODULES_DIR)/ssl/record.xsb\
	$(MODULES_DIR)/ssl/session.xsb\
	$(MODULES_DIR)/ssl/setup.xsb\
	$(MODULES_DIR)/ssl/stream.xsb\
	$(MODULES_DIR)/pins/analog.xsb\
	$(MODULES_DIR)/mc/config.xsb\
	$(TMP_DIR)/modTime.c.xsi\
	$(TMP_DIR)/modTimer.c.xsi\
	$(TMP_DIR)/timer.c.xsi\
	$(TMP_DIR)/Resource.c.xsi\
	$(TMP_DIR)/modInstrumentation.c.xsi\
	$(TMP_DIR)/modLwipSafe.c.xsi\
	$(TMP_DIR)/modSocket.c.xsi\
	$(TMP_DIR)/modNet.c.xsi\
	$(TMP_DIR)/modResolve.c.xsi\
	$(TMP_DIR)/modsntp.c.xsi\
	$(TMP_DIR)/xs6wifi.c.xsi\
	$(TMP_DIR)/moddnsparser.c.xsi\
	$(TMP_DIR)/ec.c.xsi\
	$(TMP_DIR)/modular.c.xsi\
	$(TMP_DIR)/mont.c.xsi\
	$(TMP_DIR)/xsBigIntEx.c.xsi\
	$(TMP_DIR)/bin.c.xsi\
	$(TMP_DIR)/modCrypt.c.xsi\
	$(TMP_DIR)/chacha.c.xsi\
	$(TMP_DIR)/fips180.c.xsi\
	$(TMP_DIR)/fips197.c.xsi\
	$(TMP_DIR)/fips46.c.xsi\
	$(TMP_DIR)/ghash.c.xsi\
	$(TMP_DIR)/rc.c.xsi\
	$(TMP_DIR)/rfc1321.c.xsi\
	$(TMP_DIR)/rng.c.xsi\
	$(TMP_DIR)/x509.c.xsi\
	$(TMP_DIR)/modsecuresocket.c.xsi\
	$(TMP_DIR)/modBase64.c.xsi\
	$(TMP_DIR)/modHex.c.xsi\
	$(TMP_DIR)/analog.c.xsi\
	$(TMP_DIR)/modFile.c.xsi\
	$(TMP_DIR)/loadmod.c.xsi\
	$(TMP_DIR)/modLogical.c.xsi\
	$(TMP_DIR)/flash.c.xsi\
	$(TMP_DIR)/modTimer.h.xsi\
	$(TMP_DIR)/modInstrumentation.h.xsi\
	$(TMP_DIR)/modLwipSafe.h.xsi\
	$(TMP_DIR)/modSocket.h.xsi\
	$(TMP_DIR)/xsBigIntEx.h.xsi\
	$(TMP_DIR)/chacha.h.xsi\
	$(TMP_DIR)/fips180.h.xsi\
	$(TMP_DIR)/fips197.h.xsi\
	$(TMP_DIR)/fips46.h.xsi\
	$(TMP_DIR)/ghash.h.xsi\
	$(TMP_DIR)/kcl.h.xsi\
	$(TMP_DIR)/kcl_symmetric.h.xsi\
	$(TMP_DIR)/rc.h.xsi\
	$(TMP_DIR)/rfc1321.h.xsi
PRELOADS =\
	-p Resource.xsb\
	-p instrumentation.xsb\
	-p socket.xsb\
	-p setup/network.xsb\
	-p sntp.xsb\
	-p wifi.xsb\
	-p net.xsb\
	-p mdns.xsb\
	-p dns.xsb\
	-p rng.xsb\
	-p securesocket.xsb\
	-p ssl/alert.xsb\
	-p ssl/cache.xsb\
	-p ssl/cert.xsb\
	-p ssl/changecipher.xsb\
	-p ssl/ciphersuites.xsb\
	-p ssl/constants.xsb\
	-p ssl/handshake.xsb\
	-p ssl/prf.xsb\
	-p ssl/record.xsb\
	-p ssl/session.xsb\
	-p ssl/setup.xsb\
	-p ssl/stream.xsb\
	-p crypt.xsb\
	-p base64.xsb\
	-p hex.xsb\
	-p Resource.xsb\
	-p pins/analog.xsb\
	-p file.xsb\
	-p http.xsb\
	-p sntp.xsb\
	-p websocket.xsb\
	-p base64.xsb\
	-p logical.xsb\
	-p mqtt.xsb\
	-p mc/config.xsb

DIRECTORIES =\
	-I/home/moddable/Projects/moddable/modules/base/timer\
	-I/home/moddable/Projects/moddable/modules/base/instrumentation\
	-I/home/moddable/Projects/moddable/modules/network/socket/lwip\
	-I/home/moddable/Projects/moddable/modules/network/socket\
	-I/home/moddable/Projects/moddable/modules/crypt/arith\
	-I/home/moddable/Projects/moddable/modules/crypt/digest/kcl
DISPLAY = 7
ROTATION = 0
HEADERS =\
	/home/moddable/Projects/moddable/modules/base/timer/modTimer.h\
	/home/moddable/Projects/moddable/modules/base/instrumentation/modInstrumentation.h\
	/home/moddable/Projects/moddable/modules/network/socket/lwip/modLwipSafe.h\
	/home/moddable/Projects/moddable/modules/network/socket/modSocket.h\
	/home/moddable/Projects/moddable/modules/crypt/arith/xsBigIntEx.h\
	/home/moddable/Projects/moddable/modules/crypt/digest/kcl/chacha.h\
	/home/moddable/Projects/moddable/modules/crypt/digest/kcl/fips180.h\
	/home/moddable/Projects/moddable/modules/crypt/digest/kcl/fips197.h\
	/home/moddable/Projects/moddable/modules/crypt/digest/kcl/fips46.h\
	/home/moddable/Projects/moddable/modules/crypt/digest/kcl/ghash.h\
	/home/moddable/Projects/moddable/modules/crypt/digest/kcl/kcl.h\
	/home/moddable/Projects/moddable/modules/crypt/digest/kcl/kcl_symmetric.h\
	/home/moddable/Projects/moddable/modules/crypt/digest/kcl/rc.h\
	/home/moddable/Projects/moddable/modules/crypt/digest/kcl/rfc1321.h\
	$(TMP_DIR)/mc.defines.h\
	$(TMP_DIR)/mc.format.h\
	$(TMP_DIR)/mc.rotation.h
OBJECTS =\
	$(TMP_DIR)/modTime.c.o\
	$(TMP_DIR)/modTimer.c.o\
	$(TMP_DIR)/timer.c.o\
	$(TMP_DIR)/Resource.c.o\
	$(TMP_DIR)/modInstrumentation.c.o\
	$(TMP_DIR)/modLwipSafe.c.o\
	$(TMP_DIR)/modSocket.c.o\
	$(TMP_DIR)/modNet.c.o\
	$(TMP_DIR)/modResolve.c.o\
	$(TMP_DIR)/modsntp.c.o\
	$(TMP_DIR)/xs6wifi.c.o\
	$(TMP_DIR)/moddnsparser.c.o\
	$(TMP_DIR)/ec.c.o\
	$(TMP_DIR)/modular.c.o\
	$(TMP_DIR)/mont.c.o\
	$(TMP_DIR)/xsBigIntEx.c.o\
	$(TMP_DIR)/bin.c.o\
	$(TMP_DIR)/modCrypt.c.o\
	$(TMP_DIR)/chacha.c.o\
	$(TMP_DIR)/fips180.c.o\
	$(TMP_DIR)/fips197.c.o\
	$(TMP_DIR)/fips46.c.o\
	$(TMP_DIR)/ghash.c.o\
	$(TMP_DIR)/rc.c.o\
	$(TMP_DIR)/rfc1321.c.o\
	$(TMP_DIR)/rng.c.o\
	$(TMP_DIR)/x509.c.o\
	$(TMP_DIR)/modsecuresocket.c.o\
	$(TMP_DIR)/modBase64.c.o\
	$(TMP_DIR)/modHex.c.o\
	$(TMP_DIR)/analog.c.o\
	$(TMP_DIR)/modFile.c.o\
	$(TMP_DIR)/loadmod.c.o\
	$(TMP_DIR)/modLogical.c.o\
	$(TMP_DIR)/flash.c.o
DATA =

BLE =\
	$(TMP_DIR)/mc.bleservices

RESOURCES = $(STRINGS)\
	$(RESOURCES_DIR)/ca.ski\
	$(RESOURCES_DIR)/ca.subject

#
# Copyright (c) 2016-2020  Moddable Tech, Inc.
#
#   This file is part of the Moddable SDK Tools.
# 
#   The Moddable SDK Tools is free software: you can redistribute it and/or modify
#   it under the terms of the GNU General Public License as published by
#   the Free Software Foundation, either version 3 of the License, or
#   (at your option) any later version.
# 
#   The Moddable SDK Tools is distributed in the hope that it will be useful,
#   but WITHOUT ANY WARRANTY; without even the implied warranty of
#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#   GNU General Public License for more details.
# 
#   You should have received a copy of the GNU General Public License
#   along with the Moddable SDK Tools.  If not, see <http://www.gnu.org/licenses/>.
#

HOST_OS := $(shell uname)

UPLOAD_SPEED ?= 921600
DEBUGGER_SPEED ?= 460800
ESP32_CMAKE ?= 1

EXPECTED_ESP_IDF ?= v3.3.2

ifeq ($(VERBOSE),1)
	CMAKE_LOG_LEVEL = VERBOSE
	IDF_PY_LOG_FLAG = -v
else
	CMAKE_LOG_LEVEL = ERROR
	IDF_PY_LOG_FLAG = -n
endif

ESP32_BASE ?= $(HOME)/esp32
IDF_PATH ?= $(ESP32_BASE)/esp-idf
export IDF_PATH
TOOLS_ROOT ?= $(ESP32_BASE)/xtensa-esp32-elf
PLATFORM_DIR = $(MODDABLE)/build/devices/esp32

IDF_VERSION := $(shell bash -c "cd $(IDF_PATH) && git describe --always")

ifeq ($(IDF_VERSION),)
$(warning Could not detect ESP-IDF version.)
else
ifneq ($(IDF_VERSION),$(EXPECTED_ESP_IDF))
$(error Detected ESP-IDF version $(IDF_VERSION). Expected ESP-IDF version $(EXPECTED_ESP_IDF).)
endif
endif

unexport LDFLAGS
unexport LD_LIBRARY_PATH
unexport CPPFLAGS

ifeq ($(DEBUG),1)
	IDF_BUILD_DIR = $(BUILD_DIR)/tmp/$(FULLPLATFORM)/debug/idf
	PROJ_DIR = $(BUILD_DIR)/tmp/$(FULLPLATFORM)/debug/xsProj
else
	IDF_BUILD_DIR = $(BUILD_DIR)/tmp/$(FULLPLATFORM)/release/idf
	PROJ_DIR = $(BUILD_DIR)/tmp/$(FULLPLATFORM)/release/xsProj
endif

ifeq ($(MAKEFLAGS_JOBS),)
	MAKEFLAGS_JOBS = --jobs
endif

ifeq ($(DEBUG),1)
	LIB_DIR = $(BUILD_DIR)/tmp/$(FULLPLATFORM)/debug/lib
else
	ifeq ($(INSTRUMENT),1)
		LIB_DIR = $(BUILD_DIR)/tmp/$(FULLPLATFORM)/instrument/lib
	else
		LIB_DIR = $(BUILD_DIR)/tmp/$(FULLPLATFORM)/release/lib
	endif
endif

ifeq ($(ESP32_CMAKE),1)
	SDKCONFIG_H_DIR = $(IDF_BUILD_DIR)/config
else
	SDKCONFIG_H_DIR = $(IDF_BUILD_DIR)/include
endif

INC_DIRS = \
 	$(IDF_PATH)/components \
 	$(IDF_PATH)/components/bootloader_support/include \
 	$(IDF_PATH)/components/bt/include \
 	$(IDF_PATH)/components/bt/bluedroid/api/include \
 	$(IDF_PATH)/components/bt/bluedroid/api/include/api \
 	$(IDF_PATH)/components/driver/include \
 	$(IDF_PATH)/components/esp32/include \
 	$(IDF_PATH)/components/esp_event/include \
 	$(IDF_PATH)/components/esp_ringbuf/include \
 	$(IDF_PATH)/components/esp32/include \
 	$(IDF_PATH)/components/freertos \
 	$(IDF_PATH)/components/freertos/include \
 	$(IDF_PATH)/components/freertos/include/freertos \
	$(IDF_PATH)/components/heap/include \
 	$(IDF_PATH)/components/log/include \
 	$(IDF_PATH)/components/lwip/include/apps/ \
	$(IDF_PATH)/components/lwip/include/apps/sntp \
 	$(IDF_PATH)/components/lwip/lwip/src/include/ \
 	$(IDF_PATH)/components/lwip/port/esp32/ \
 	$(IDF_PATH)/components/lwip/port/esp32/include/ \
 	$(IDF_PATH)/components/mbedtls/mbedtls/include/ \
 	$(IDF_PATH)/components/newlib/include \
 	$(IDF_PATH)/components/newlib/platform_include \
 	$(IDF_PATH)/components/nimble/esp-hci/include \
 	$(IDF_PATH)/components/nimble/nimble/nimble/host/include \
 	$(IDF_PATH)/components/nimble/nimble/nimble/host/services/gap/include \
 	$(IDF_PATH)/components/nimble/nimble/nimble/host/src \
 	$(IDF_PATH)/components/nimble/nimble/nimble/include \
 	$(IDF_PATH)/components/nimble/nimble/nimble/include/nimble \
 	$(IDF_PATH)/components/nimble/nimble/porting/nimble/include \
 	$(IDF_PATH)/components/nimble/nimble/porting/npl/freertos/include \
 	$(IDF_PATH)/components/nimble/port/include \
 	$(IDF_PATH)/components/soc/esp32/include \
 	$(IDF_PATH)/components/soc/esp32/include/soc \
 	$(IDF_PATH)/components/soc/include \
 	$(IDF_PATH)/components/spiffs/include \
	$(IDF_PATH)/components/fatfs/src \
	$(IDF_PATH)/components/wear_levelling/include \
 	$(IDF_PATH)/components/spi_flash/include \
 	$(IDF_PATH)/components/tcpip_adapter/include \
 	$(IDF_PATH)/components/tcpip_adapter \
 	$(IDF_PATH)/components/vfs/include
    
XS_OBJ = \
	$(LIB_DIR)/xsAll.c.o \
	$(LIB_DIR)/xsAPI.c.o \
	$(LIB_DIR)/xsArguments.c.o \
	$(LIB_DIR)/xsArray.c.o \
	$(LIB_DIR)/xsAtomics.c.o \
	$(LIB_DIR)/xsBigInt.c.o \
	$(LIB_DIR)/xsBoolean.c.o \
	$(LIB_DIR)/xsCode.c.o \
	$(LIB_DIR)/xsCommon.c.o \
	$(LIB_DIR)/xsDataView.c.o \
	$(LIB_DIR)/xsDate.c.o \
	$(LIB_DIR)/xsDebug.c.o \
	$(LIB_DIR)/xsError.c.o \
	$(LIB_DIR)/xsFunction.c.o \
	$(LIB_DIR)/xsGenerator.c.o \
	$(LIB_DIR)/xsGlobal.c.o \
	$(LIB_DIR)/xsJSON.c.o \
	$(LIB_DIR)/xsLexical.c.o \
	$(LIB_DIR)/xsMapSet.c.o \
	$(LIB_DIR)/xsMarshall.c.o \
	$(LIB_DIR)/xsMath.c.o \
	$(LIB_DIR)/xsMemory.c.o \
	$(LIB_DIR)/xsModule.c.o \
	$(LIB_DIR)/xsNumber.c.o \
	$(LIB_DIR)/xsObject.c.o \
	$(LIB_DIR)/xsPromise.c.o \
	$(LIB_DIR)/xsProperty.c.o \
	$(LIB_DIR)/xsProxy.c.o \
	$(LIB_DIR)/xsRegExp.c.o \
	$(LIB_DIR)/xsRun.c.o \
	$(LIB_DIR)/xsScope.c.o \
	$(LIB_DIR)/xsScript.c.o \
	$(LIB_DIR)/xsSourceMap.c.o \
	$(LIB_DIR)/xsString.c.o \
	$(LIB_DIR)/xsSymbol.c.o \
	$(LIB_DIR)/xsSyntaxical.c.o \
	$(LIB_DIR)/xsTree.c.o \
	$(LIB_DIR)/xsType.c.o \
	$(LIB_DIR)/xsdtoa.c.o \
	$(LIB_DIR)/xsre.c.o \
	$(LIB_DIR)/xsmc.c.o \
	$(LIB_DIR)/e_pow.c.o
XS_DIRS = \
	$(XS_DIR)/includes \
	$(XS_DIR)/sources \
	$(XS_DIR)/platforms/esp \
	$(SDKCONFIG_H_DIR) \
	$(PLATFORM_DIR)/lib/pow
XS_HEADERS = \
	$(XS_DIR)/includes/xs.h \
	$(XS_DIR)/includes/xsmc.h \
	$(XS_DIR)/sources/xsAll.h \
	$(XS_DIR)/sources/xsCommon.h \
	$(XS_DIR)/platforms/esp/xsHost.h \
	$(XS_DIR)/platforms/esp/xsPlatform.h
HEADERS += $(XS_HEADERS)

TOOLS_BIN = $(TOOLS_ROOT)/bin
CC  = $(TOOLS_BIN)/xtensa-esp32-elf-gcc
CPP = $(TOOLS_BIN)/xtensa-esp32-elf-g++
LD  = $(CPP)
AR  = $(TOOLS_BIN)/xtensa-esp32-elf-ar
OBJCOPY = $(TOOLS_BIN)/xtensa-esp32-elf-objcopy
ESPTOOL = $(IDF_PATH)/components/esptool_py/esptool/esptool.py

AR_FLAGS = crs

ifeq ($(HOST_OS),Darwin)
MODDABLE_TOOLS_DIR = $(BUILD_DIR)/bin/mac/release
else
MODDABLE_TOOLS_DIR = $(BUILD_DIR)/bin/lin/release
endif
BUILDCLUT = $(MODDABLE_TOOLS_DIR)/buildclut
COMPRESSBMF = $(MODDABLE_TOOLS_DIR)/compressbmf
RLE4ENCODE = $(MODDABLE_TOOLS_DIR)/rle4encode
MCLOCAL = $(MODDABLE_TOOLS_DIR)/mclocal
MCREZ = $(MODDABLE_TOOLS_DIR)/mcrez
PNG2BMP = $(MODDABLE_TOOLS_DIR)/png2bmp
IMAGE2CS = $(MODDABLE_TOOLS_DIR)/image2cs
WAV2MAUD = $(MODDABLE_TOOLS_DIR)/wav2maud
BLES2GATT = $(MODDABLE_TOOLS_DIR)/bles2gatt
XSC = $(MODDABLE_TOOLS_DIR)/xsc
XSID = $(MODDABLE_TOOLS_DIR)/xsid
XSL = $(MODDABLE_TOOLS_DIR)/xsl

#	-DICACHE_FLASH
#	-DmxNoConsole=1
C_DEFINES = \
	-D__ets__ \
	-U__STRICT_ANSI__ \
	-DESP32=1 \
	$(NET_CONFIG_FLAGS) \
	-DmxUseDefaultSharedChunks=1 \
	-DmxRun=1 \
	-DkCommodettoBitmapFormat=$(DISPLAY) \
	-DkPocoRotation=$(ROTATION)
ifeq ($(DEBUG),1)
	C_DEFINES += -DmxDebug=1
endif
ifeq ($(INSTRUMENT),1)
	C_DEFINES += -DMODINSTRUMENTATION=1 -DmxInstrument=1
endif
C_INCLUDES += $(DIRECTORIES)
C_INCLUDES += $(foreach dir,$(INC_DIRS) $(SDK_DIRS) $(XS_DIRS) $(LIB_DIR) $(TMP_DIR),-I$(dir))

C_COMMON_FLAGS ?= -c -Os -g \
	-Wno-unused-variable \
	-Wpointer-arith \
	-Wl,-EL \
	-fno-inline-functions \
	-nostdlib \
	-mlongcalls \
	-mtext-section-literals \
	-falign-functions=4 \
	-MMD \
	-fdata-sections \
	-ffunction-sections \
	-fno-jump-tables \
	-fstrict-volatile-bitfields \
	-DWITH_POSIX \
	-DHAVE_CONFIG_H \
	-D BOOTLOADER_BUILD=1 \
	-DESP_PLATFORM \
	-MP

C_FLAGS ?= $(C_COMMON_FLAGS) \
	-Wno-implicit-function-declaration \
	-std=gnu99

CPP_FLAGS ?= $(C_COMMON_FLAGS)

# Utility functions
git_description = $(shell git -C  $(1) describe --tags --always --dirty 2>/dev/null)
SRC_GIT_VERSION = $(call git_description,$(BASE)/sources)
ESP_GIT_VERSION = $(call git_description,$(ARDUINO_ROOT))
time_string = $(shell perl -e 'use POSIX qw(strftime); print strftime($(1), localtime());')
BUILD_DATE = $(call time_string,"%Y-%m-%d")
BUILD_TIME = $(call time_string,"%H:%M:%S")
MEM_USAGE = \
  'while (<>) { \
      $$r += $$1 if /^\.(?:data|rodata|bss)\s+(\d+)/;\
		  $$f += $$1 if /^\.(?:irom0\.text|text|data|rodata)\s+(\d+)/;\
	 }\
	 print "\# Memory usage\n";\
	 print sprintf("\#  %-6s %6d bytes\n" x 2 ."\n", "Ram:", $$r, "Flash:", $$f);'

VPATH += $(SDK_DIRS) $(XS_DIRS)

.PHONY: all partitionsFileCheck

PARTITIONS_FILE ?= $(PROJ_DIR_TEMPLATE)/partitions.csv

PROJ_DIR_TEMPLATE = $(BUILD_DIR)/devices/esp32/xsProj
PROJ_DIR_FILES = \
	$(PROJ_DIR)/main/main.c \
	$(PROJ_DIR)/main/component.mk \
	$(PROJ_DIR)/partitions.csv \
	$(PROJ_DIR)/Makefile

ifeq ($(ESP32_CMAKE),1)
	ifeq ($(UPLOAD_PORT),)
		PORT_SET =
		SERIAL2XSBUG_PORT = $$PORT_USED
	else
		PORT_SET = -p $(UPLOAD_PORT)
		SERIAL2XSBUG_PORT = $(UPLOAD_PORT)
	endif
	BUILD_AND_FLASH_CMD = idf.py $(PORT_SET) -b $(UPLOAD_SPEED) -B $(IDF_BUILD_DIR) $(IDF_PY_LOG_FLAG) build flash -D mxDebug=$(DEBUG) SDKCONFIG_H="$(SDKCONFIG_H)" CMAKE_MESSAGE_LOG_LEVEL=$(CMAKE_LOG_LEVEL) DEBUGGER_SPEED=$(DEBUGGER_SPEED)
	BUILD_CMD = idf.py -B $(IDF_BUILD_DIR) $(IDF_PY_LOG_FLAG) build -D mxDebug=$(DEBUG) SDKCONFIG_H="$(SDKCONFIG_H)" CMAKE_MESSAGE_LOG_LEVEL=$(CMAKE_LOG_LEVEL) DEBUGGER_SPEED=$(DEBUGGER_SPEED)
	BUILD_ERR = "ESP-IDF Build Failed"
	DEPLOY_CMD = idf.py $(PORT_SET) -b $(UPLOAD_SPEED) -B $(IDF_BUILD_DIR) $(IDF_PY_LOG_FLAG) flash -D mxDebug=$(DEBUG) SDKCONFIG_H="$(SDKCONFIG_H)" CMAKE_MESSAGE_LOG_LEVEL=$(CMAKE_LOG_LEVEL) DEBUGGER_SPEED=$(DEBUGGER_SPEED)
	IDF_RECONFIGURE_CMD = idf.py -B $(IDF_BUILD_DIR) $(IDF_PY_LOG_FLAG) reconfigure -D SDKCONFIG_DEFAULTS=$(SDKCONFIG_FILE) SDKCONFIG_H="$(SDKCONFIG_H)" CMAKE_MESSAGE_LOG_LEVEL=$(CMAKE_LOG_LEVEL) DEBUGGER_SPEED=$(DEBUGGER_SPEED)
	RELEASE_LAUNCH_CMD = idf.py -B $(IDF_BUILD_DIR) $(PORT_SET) $(IDF_PY_LOG_FLAG) monitor -D CMAKE_MESSAGE_LOG_LEVEL=$(CMAKE_LOG_LEVEL)
	PARTITIONS_BIN = partition-table.bin
	PARTITIONS_PATH = $(IDF_BUILD_DIR)/partition_table/$(PARTITIONS_BIN)
else
	BUILD_AND_FLASH_CMD = IDF_BUILD_DIR=$(IDF_BUILD_DIR) DEBUG=$(DEBUG) SDKCONFIG_DEFAULTS=$(SDKCONFIG_FILE) DEBUGGER_SPEED=$(DEBUGGER_SPEED) make flash
	BUILD_CMD = IDF_BUILD_DIR=$(IDF_BUILD_DIR) DEBUG=$(DEBUG) SDKCONFIG_DEFAULTS=$(SDKCONFIG_FILE) DEBUGGER_SPEED=$(DEBUGGER_SPEED) make --silent
	BUILD_ERR = "ESP-IDF build failed (perhaps due to parallel build race conditions). Please try again."
	DEPLOY_CMD = IDF_BUILD_DIR=$(IDF_BUILD_DIR) DEBUG=$(DEBUG) SDKCONFIG_DEFAULTS=$(SDKCONFIG_FILE) DEBUGGER_SPEED=$(DEBUGGER_SPEED) make flash
	IDF_RECONFIGURE_CMD = IDF_BUILD_DIR=$(IDF_BUILD_DIR) BATCH_BUILD=1 DEBUG=$(DEBUG) SDKCONFIG_DEFAULTS=$(SDKCONFIG_FILE) make defconfig
	RELEASE_LAUNCH_CMD = IDF_BUILD_DIR=$(IDF_BUILD_DIR) SDKCONFIG_DEFAULTS=$(SDKCONFIG_FILE) DEBUGGER_SPEED=$(DEBUGGER_SPEED) make monitor
	PARTITIONS_BIN = partitions.bin
	PARTITIONS_PATH = $(IDF_BUILD_DIR)/$(PARTITIONS_BIN)
	ifeq ($(HOST_OS),Darwin)
		SERIAL2XSBUG_PORT = `/usr/bin/grep ^CONFIG_ESPTOOLPY_PORT $(PROJ_DIR)/sdkconfig | /usr/bin/grep -o '"[^"]*"' | tr -d '"'`
	else
		SERIAL2XSBUG_PORT = `grep ^CONFIG_ESPTOOLPY_PORT $(PROJ_DIR)/sdkconfig | grep -o '"[^"]*"' | tr -d '"'`
	endif
endif

ifeq ($(DEBUG),1)
	ifeq ($(HOST_OS),Darwin)
		KILL_SERIAL_2_XSBUG = $(shell pkill serial2xsbug)
		DO_XSBUG = open -a $(BUILD_DIR)/bin/mac/release/xsbug.app -g
		DO_LAUNCH = bash -c "serial2xsbug $(SERIAL2XSBUG_PORT) $(DEBUGGER_SPEED) 8N1 -elf $(IDF_BUILD_DIR)/xs_esp32.elf -bin $(TOOLS_ROOT)/bin/xtensa-esp32-elf-gdb"
	else
		KILL_SERIAL_2_XSBUG = $(shell pkill serial2xsbug)
		DO_XSBUG = $(shell nohup $(BUILD_DIR)/bin/lin/release/xsbug > /dev/null 2>&1 &)
		DO_LAUNCH = bash -c "serial2xsbug $(SERIAL2XSBUG_PORT) $(DEBUGGER_SPEED) 8N1"
	endif
else
	KILL_SERIAL_2_XSBUG = 
	DO_XSBUG = 
	DO_LAUNCH = cd $(PROJ_DIR); $(RELEASE_LAUNCH_CMD)
endif

SDKCONFIGPATH ?= $(PROJ_DIR)
SDKCONFIG = $(SDKCONFIGPATH)/sdkconfig.defaults
SDKCONFIGPRIOR = $(SDKCONFIGPATH)/sdkconfig.defaults.prior
SDKCONFIG_H = $(SDKCONFIG_H_DIR)/sdkconfig.h


.NOTPARALLEL: $(SDKCONFIG_H)

all: precursor
	$(KILL_SERIAL_2_XSBUG)
	$(DO_XSBUG)
	cd $(PROJ_DIR) ; $(BUILD_CMD) || (echo $(BUILD_ERR) && exit 1)
	-cp $(IDF_BUILD_DIR)/xs_esp32.map $(BIN_DIR)
	-cp $(IDF_BUILD_DIR)/xs_esp32.bin $(BIN_DIR)
	-cp $(PARTITIONS_PATH) $(BIN_DIR)
	-cp $(IDF_BUILD_DIR)/bootloader/bootloader.bin $(BIN_DIR)
	-cp $(IDF_BUILD_DIR)/ota_data_initial.bin $(BIN_DIR) 2>/dev/null
	cd $(PROJ_DIR) ; bash -c "set -o pipefail; $(DEPLOY_CMD) | tee $(PROJ_DIR)/flashOutput"
	PORT_USED=$$(grep 'Serial port' $(PROJ_DIR)/flashOutput | awk '{print($$3)}'); \
	cd $(PROJ_DIR); \
	$(DO_LAUNCH)

DEPLOY_PRE:
	if ! test -e $(BIN_DIR)/xs_esp32.bin ; then (echo "Please build before deploy" && exit 1) fi
	@echo "# uploading to esp32"
	-@mv $(IDF_BUILD_DIR)/xs_esp32.bin $(IDF_BUILD_DIR)/xs_esp32.bin_prev 2>/dev/null
	-@mv $(PARTITIONS_PATH) $(PARTITIONS_BIN)_prev 2>/dev/null
	-@mv $(IDF_BUILD_DIR)/bootloader/bootloader.bin $(IDF_BUILD_DIR)/bootloader/bootloader.bin_prev 2>/dev/null
	-@mv $(IDF_BUILD_DIR)/ota_data_initial.bin $(IDF_BUILD_DIR)/ota_data_initial.bin_prev 2>&1

DEPLOY_START:
	-cp $(BIN_DIR)/xs_esp32.bin $(IDF_BUILD_DIR)
	-cp $(BIN_DIR)/$(PARTITIONS_BIN) $(PARTITIONS_PATH)
	-cp $(BIN_DIR)/bootloader.bin $(IDF_BUILD_DIR)/bootloader/bootloader.bin
	-cp $(BIN_DIR)/ota_data_initial.bin $(IDF_BUILD_DIR)/ota_data_initial.bin
	-cd $(PROJ_DIR) ; $(DEPLOY_CMD) | tee $(PROJ_DIR)/flashOutput

DEPLOY_END:
	-@mv $(IDF_BUILD_DIR)/xs_esp32.bin_prev $(IDF_BUILD_DIR)/xs_esp32.bin 2>/dev/null
	-@mv $(PARTITIONS_BIN)_prev $(PARTITIONS_PATH) 2>/dev/null
	-@mv $(IDF_BUILD_DIR)/bootloader/bootloader.bin_prev $(IDF_BUILD_DIR)/bootloader/bootloader.bin 2>/dev/null
	-@mv $(IDF_BUILD_DIR)/ota_data_initial.bin_prev $(IDF_BUILD_DIR)/ota_data_initial.bin 2>/dev/null

deploy: DEPLOY_PRE DEPLOY_START DEPLOY_END

xsbug:
	@echo "# starting xsbug"
	$(KILL_SERIAL2XSBUG)
	$(DO_XSBUG)
	PORT_USED=$$(grep 'Serial port' $(PROJ_DIR)/flashOutput | awk '{print($$3)}'); \
	$(DO_LAUNCH)

prepareOutput:
	-@rm $(IDF_BUILD_DIR)/xs_esp32.elf 2>/dev/null
	-@rm $(BIN_DIR)/xs_esp32.elf 2>/dev/null
	-@mkdir -p $(IDF_BUILD_DIR) 2>/dev/null

precursor: partitionsFileCheck prepareOutput projDir $(BLE) $(SDKCONFIG_H) $(LIB_DIR) $(BIN_DIR)/xs_esp32.a
	cp $(BIN_DIR)/xs_esp32.a $(IDF_BUILD_DIR)/.
	touch $(PROJ_DIR)/main/main.c

build: precursor
	-cd $(PROJ_DIR) ; $(BUILD_CMD)
	-cp $(IDF_BUILD_DIR)/xs_esp32.map $(BIN_DIR)
	-cp $(IDF_BUILD_DIR)/xs_esp32.bin $(BIN_DIR)
	-cp $(IDF_BUILD_DIR)/bootloader/bootloader.bin $(BIN_DIR)
	-cp $(PARTITIONS_PATH) $(BIN_DIR)
	-cp $(IDF_BUILD_DIR)/ota_data_initial.bin $(BIN_DIR) 2>&1
	echo "#"
	echo "# Built files at $(BIN_DIR)"
	echo "#"

clean:
	echo "# Clean project"
	-rm -rf $(BIN_DIR) 2>/dev/null
	-rm -rf $(TMP_DIR) 2>/dev/null
	-rm -rf $(LIB_DIR) 2>/dev/null
	-rm -rf $(IDF_BUILD_DIR) 2>/dev/null
	-rm -rf $(PROJ_DIR) 2>/dev/null

erase_flash:
	$(ESPTOOL) --chip esp32 --port $(UPLOAD_PORT) erase_flash
	

$(SDKCONFIG_H): $(SDKCONFIG_FILE)
	if ! test -s $(SDKCONFIGPRIOR) ; then cp $(SDKCONFIG_FILE) $(SDKCONFIGPRIOR); fi
	if ! test -s $(IDF_BUILD_DIR)/; then rm -f $(SDKCONFIGPRIOR); fi
	if ! test -s $(SDKCONFIG_H) \
		|| ! cmp -s "$(SDKCONFIGPRIOR)" "$(SDKCONFIG_FILE)" \
		|| ! cmp -s "$(PROJ_DIR)/sdkconfig" "$(SDKCONFIGPATH)/sdkconfig.old"; then \
		rm $(PROJ_DIR)/sdkconfig; \
		cp $(SDKCONFIG_FILE) $(SDKCONFIGPRIOR); \
		echo "# Reconfiguring ESP-IDF..." ; cd $(PROJ_DIR) ; $(IDF_RECONFIGURE_CMD); \
		if test -s $(PROJ_DIR)/sdkconfig.old ; then mv $(PROJ_DIR)/sdkconfig.old $(SDKCONFIGPATH)/sdkconfig.old; fi ;\
	fi

$(LIB_DIR):
	mkdir -p $(LIB_DIR)
	echo "typedef struct { const char *date, *time, *src_version, *env_version;} _tBuildInfo; extern _tBuildInfo _BuildInfo;" > $(LIB_DIR)/buildinfo.h
	
$(BIN_DIR)/xs_esp32.a: $(SDK_OBJ) $(XS_OBJ) $(TMP_DIR)/xsPlatform.c.o $(TMP_DIR)/xsHost.c.o $(TMP_DIR)/mc.xs.c.o $(TMP_DIR)/mc.resources.c.o $(OBJECTS) 
	@echo "# ld xs_esp.bin"
	echo '#include "buildinfo.h"' > $(LIB_DIR)/buildinfo.c
	echo '_tBuildInfo _BuildInfo = {"$(BUILD_DATE)","$(BUILD_TIME)","$(SRC_GIT_VERSION)","$(ESP_GIT_VERSION)"};' >> $(LIB_DIR)/buildinfo.c
	$(CC) $(C_DEFINES) $(C_INCLUDES) $(C_FLAGS) $(LIB_DIR)/buildinfo.c -o $(LIB_DIR)/buildinfo.c.o
	$(AR) $(AR_FLAGS) $(BIN_DIR)/xs_esp32.a $^ $(LIB_DIR)/buildinfo.c.o

projDir: $(PROJ_DIR) $(PROJ_DIR_FILES) $(PROJ_DIR)/partitions.csv

partitionsFileCheck:
	if test -e $(PROJ_DIR)/partitions.csv ; then \
		if ! cmp -s $(PROJ_DIR)/partitions.csv $(PARTITIONS_FILE) ; then \
			touch $(PARTITIONS_FILE); \
		fi ; \
	fi

$(PROJ_DIR): $(PROJ_DIR_TEMPLATE)
	cp -r $(PROJ_DIR_TEMPLATE) $(PROJ_DIR)
	cp $(PARTITIONS_FILE) $(PROJ_DIR)/partitions.csv

$(PROJ_DIR)/partitions.csv: $(PARTITIONS_FILE)
	cp $(PARTITIONS_FILE) $(PROJ_DIR)/partitions.csv

$(PROJ_DIR)/main/main.c: $(PROJ_DIR_TEMPLATE)/main/main.c
	cp -f $? $@

$(PROJ_DIR)/main/component.mk: $(PROJ_DIR_TEMPLATE)/main/component.mk
	cp -f $? $@

$(PROJ_DIR)/Makefile: $(PROJ_DIR_TEMPLATE)/Makefile
	cp -f $? $@

$(XS_OBJ): $(SDKCONFIG_H) $(XS_HEADERS)
$(LIB_DIR)/xs%.c.o: xs%.c
	@echo "# cc" $(<F) "(strings in flash)"
	$(CC) $(C_DEFINES) $(C_INCLUDES) $(C_FLAGS) $< -o $@
	
$(TMP_DIR)/xsPlatform.c.o: xsPlatform.c $(XS_HEADERS) $(TMP_DIR)/mc.defines.h $(TMP_DIR)/mc.format.h $(TMP_DIR)/mc.rotation.h
	@echo "# cc" $(<F) "(strings in flash)"
	$(CC) $(C_DEFINES) $(C_INCLUDES) $(C_FLAGS) $< -o $@
	
$(TMP_DIR)/xsHost.c.o: xsHost.c $(XS_HEADERS) $(TMP_DIR)/mc.defines.h $(TMP_DIR)/mc.format.h $(TMP_DIR)/mc.rotation.h
	@echo "# cc" $(<F) "(strings in flash)"
	$(CC) $(C_DEFINES) $(C_INCLUDES) $(C_FLAGS) $< -o $@

$(LIB_DIR)/%.c.o: %.c
	@echo "# cc" $(<F) "(strings in flash)"
	$(CC) $(C_DEFINES) $(C_INCLUDES) $(C_FLAGS) $< -o $@

$(TMP_DIR)/mc.%.c.o: $(TMP_DIR)/mc.%.c
	@echo "# cc" $(<F) "(slots in flash)"
	$(CC) $(C_DEFINES) $(C_INCLUDES) $(C_FLAGS) $< -o $@
	
$(TMP_DIR)/mc.xs.c: $(MODULES) $(MANIFEST)
	@echo "# xsl modules"
	$(XSL) -b $(MODULES_DIR) -o $(TMP_DIR) $(PRELOADS) $(STRIPS) $(CREATION) $(MODULES)

$(TMP_DIR)/mc.resources.c: $(DATA) $(RESOURCES) $(MANIFEST)
	@echo "# mcrez resources"
	$(MCREZ) $(DATA) $(RESOURCES) -o $(TMP_DIR) -p esp32 -r mc.resources.c
	
MAKEFLAGS += $(MAKEFLAGS_JOBS)
ifneq ($(VERBOSE),1)
MAKEFLAGS += --silent
endif


$(MODULES_DIR)/time.xsb: /home/moddable/Projects/moddable/modules/base/time/time.js
	@echo "# xsc time.xsb"
	$(XSC) /home/moddable/Projects/moddable/modules/base/time/time.js -c -e -o $(@D) -r time
$(MODULES_DIR)/timer.xsb: /home/moddable/Projects/moddable/modules/base/timer/timer.js
	@echo "# xsc timer.xsb"
	$(XSC) /home/moddable/Projects/moddable/modules/base/timer/timer.js -c -e -o $(@D) -r timer
$(MODULES_DIR)/Resource.xsb: /home/moddable/Projects/moddable/modules/files/resource/Resource.js
	@echo "# xsc Resource.xsb"
	$(XSC) /home/moddable/Projects/moddable/modules/files/resource/Resource.js -c -e -o $(@D) -r Resource
$(MODULES_DIR)/instrumentation.xsb: /home/moddable/Projects/moddable/modules/base/instrumentation/instrumentation.js
	@echo "# xsc instrumentation.xsb"
	$(XSC) /home/moddable/Projects/moddable/modules/base/instrumentation/instrumentation.js -c -e -o $(@D) -r instrumentation
$(MODULES_DIR)/socket.xsb: /home/moddable/Projects/moddable/modules/network/socket/socket.js
	@echo "# xsc socket.xsb"
	$(XSC) /home/moddable/Projects/moddable/modules/network/socket/socket.js -c -e -o $(@D) -r socket
$(MODULES_DIR)/net.xsb: /home/moddable/Projects/moddable/modules/network/net/net.js
	@echo "# xsc net.xsb"
	$(XSC) /home/moddable/Projects/moddable/modules/network/net/net.js -c -e -o $(@D) -r net
$(MODULES_DIR)/sntp.xsb: /home/moddable/Projects/moddable/modules/network/sntp/sntp.js
	@echo "# xsc sntp.xsb"
	$(XSC) /home/moddable/Projects/moddable/modules/network/sntp/sntp.js -c -e -o $(@D) -r sntp
$(MODULES_DIR)/wifi.xsb: /home/moddable/Projects/moddable/modules/network/wifi/wifi.js
	@echo "# xsc wifi.xsb"
	$(XSC) /home/moddable/Projects/moddable/modules/network/wifi/wifi.js -c -e -o $(@D) -r wifi
$(MODULES_DIR)/mdns.xsb: /home/moddable/Projects/moddable/modules/network/mdns/mdns.js
	@echo "# xsc mdns.xsb"
	$(XSC) /home/moddable/Projects/moddable/modules/network/mdns/mdns.js -c -e -o $(@D) -r mdns
$(MODULES_DIR)/dns.xsb: /home/moddable/Projects/moddable/modules/network/dns/dns.js
	@echo "# xsc dns.xsb"
	$(XSC) /home/moddable/Projects/moddable/modules/network/dns/dns.js -c -e -o $(@D) -r dns
$(MODULES_DIR)/ec.xsb: /home/moddable/Projects/moddable/modules/crypt/arith/ec.js
	@echo "# xsc ec.xsb"
	$(XSC) /home/moddable/Projects/moddable/modules/crypt/arith/ec.js -c -e -o $(@D) -r ec
$(MODULES_DIR)/ecp.xsb: /home/moddable/Projects/moddable/modules/crypt/arith/ecp.js
	@echo "# xsc ecp.xsb"
	$(XSC) /home/moddable/Projects/moddable/modules/crypt/arith/ecp.js -c -e -o $(@D) -r ecp
$(MODULES_DIR)/modular.xsb: /home/moddable/Projects/moddable/modules/crypt/arith/modular.js
	@echo "# xsc modular.xsb"
	$(XSC) /home/moddable/Projects/moddable/modules/crypt/arith/modular.js -c -e -o $(@D) -r modular
$(MODULES_DIR)/mont.xsb: /home/moddable/Projects/moddable/modules/crypt/arith/mont.js
	@echo "# xsc mont.xsb"
	$(XSC) /home/moddable/Projects/moddable/modules/crypt/arith/mont.js -c -e -o $(@D) -r mont
$(MODULES_DIR)/bin.xsb: /home/moddable/Projects/moddable/modules/crypt/bin/bin.js
	@echo "# xsc bin.xsb"
	$(XSC) /home/moddable/Projects/moddable/modules/crypt/bin/bin.js -c -e -o $(@D) -r bin
$(MODULES_DIR)/crypt.xsb: /home/moddable/Projects/moddable/modules/crypt/digest/crypt.js
	@echo "# xsc crypt.xsb"
	$(XSC) /home/moddable/Projects/moddable/modules/crypt/digest/crypt.js -c -e -o $(@D) -r crypt
$(MODULES_DIR)/ber.xsb: /home/moddable/Projects/moddable/modules/crypt/etc/ber.js
	@echo "# xsc ber.xsb"
	$(XSC) /home/moddable/Projects/moddable/modules/crypt/etc/ber.js -c -e -o $(@D) -r ber
$(MODULES_DIR)/curve.xsb: /home/moddable/Projects/moddable/modules/crypt/etc/curve.js
	@echo "# xsc curve.xsb"
	$(XSC) /home/moddable/Projects/moddable/modules/crypt/etc/curve.js -c -e -o $(@D) -r curve
$(MODULES_DIR)/dsa.xsb: /home/moddable/Projects/moddable/modules/crypt/etc/dsa.js
	@echo "# xsc dsa.xsb"
	$(XSC) /home/moddable/Projects/moddable/modules/crypt/etc/dsa.js -c -e -o $(@D) -r dsa
$(MODULES_DIR)/ecdsa.xsb: /home/moddable/Projects/moddable/modules/crypt/etc/ecdsa.js
	@echo "# xsc ecdsa.xsb"
	$(XSC) /home/moddable/Projects/moddable/modules/crypt/etc/ecdsa.js -c -e -o $(@D) -r ecdsa
$(MODULES_DIR)/gcm.xsb: /home/moddable/Projects/moddable/modules/crypt/etc/gcm.js
	@echo "# xsc gcm.xsb"
	$(XSC) /home/moddable/Projects/moddable/modules/crypt/etc/gcm.js -c -e -o $(@D) -r gcm
$(MODULES_DIR)/hmac.xsb: /home/moddable/Projects/moddable/modules/crypt/etc/hmac.js
	@echo "# xsc hmac.xsb"
	$(XSC) /home/moddable/Projects/moddable/modules/crypt/etc/hmac.js -c -e -o $(@D) -r hmac
$(MODULES_DIR)/pkcs1.xsb: /home/moddable/Projects/moddable/modules/crypt/etc/pkcs1.js
	@echo "# xsc pkcs1.xsb"
	$(XSC) /home/moddable/Projects/moddable/modules/crypt/etc/pkcs1.js -c -e -o $(@D) -r pkcs1
$(MODULES_DIR)/pkcs1_5.xsb: /home/moddable/Projects/moddable/modules/crypt/etc/pkcs1_5.js
	@echo "# xsc pkcs1_5.xsb"
	$(XSC) /home/moddable/Projects/moddable/modules/crypt/etc/pkcs1_5.js -c -e -o $(@D) -r pkcs1_5
$(MODULES_DIR)/pkcs8.xsb: /home/moddable/Projects/moddable/modules/crypt/etc/pkcs8.js
	@echo "# xsc pkcs8.xsb"
	$(XSC) /home/moddable/Projects/moddable/modules/crypt/etc/pkcs8.js -c -e -o $(@D) -r pkcs8
$(MODULES_DIR)/rng.xsb: /home/moddable/Projects/moddable/modules/crypt/etc/rng.js
	@echo "# xsc rng.xsb"
	$(XSC) /home/moddable/Projects/moddable/modules/crypt/etc/rng.js -c -e -o $(@D) -r rng
$(MODULES_DIR)/rsa.xsb: /home/moddable/Projects/moddable/modules/crypt/etc/rsa.js
	@echo "# xsc rsa.xsb"
	$(XSC) /home/moddable/Projects/moddable/modules/crypt/etc/rsa.js -c -e -o $(@D) -r rsa
$(MODULES_DIR)/x509.xsb: /home/moddable/Projects/moddable/modules/crypt/etc/x509.js
	@echo "# xsc x509.xsb"
	$(XSC) /home/moddable/Projects/moddable/modules/crypt/etc/x509.js -c -e -o $(@D) -r x509
$(MODULES_DIR)/securesocket.xsb: /home/moddable/Projects/moddable/modules/crypt/securesocket/securesocket.js
	@echo "# xsc securesocket.xsb"
	$(XSC) /home/moddable/Projects/moddable/modules/crypt/securesocket/securesocket.js -c -e -o $(@D) -r securesocket
$(MODULES_DIR)/base64.xsb: /home/moddable/Projects/moddable/modules/data/base64/base64.js
	@echo "# xsc base64.xsb"
	$(XSC) /home/moddable/Projects/moddable/modules/data/base64/base64.js -c -e -o $(@D) -r base64
$(MODULES_DIR)/hex.xsb: /home/moddable/Projects/moddable/modules/data/hex/hex.js
	@echo "# xsc hex.xsb"
	$(XSC) /home/moddable/Projects/moddable/modules/data/hex/hex.js -c -e -o $(@D) -r hex
$(MODULES_DIR)/file.xsb: /home/moddable/Projects/moddable/modules/files/file/file.js
	@echo "# xsc file.xsb"
	$(XSC) /home/moddable/Projects/moddable/modules/files/file/file.js -c -e -o $(@D) -r file
$(MODULES_DIR)/main.xsb: /home/moddable/Projects/iot-product-dev-book/temp-monitor/host/main.js
	@echo "# xsc main.xsb"
	$(XSC) /home/moddable/Projects/iot-product-dev-book/temp-monitor/host/main.js -c -e -o $(@D) -r main
$(MODULES_DIR)/loadmod.xsb: /home/moddable/Projects/iot-product-dev-book/loadmod/loadmod.js
	@echo "# xsc loadmod.xsb"
	$(XSC) /home/moddable/Projects/iot-product-dev-book/loadmod/loadmod.js -c -e -o $(@D) -r loadmod
$(MODULES_DIR)/http.xsb: /home/moddable/Projects/moddable/modules/network/http/http.js
	@echo "# xsc http.xsb"
	$(XSC) /home/moddable/Projects/moddable/modules/network/http/http.js -c -e -o $(@D) -r http
$(MODULES_DIR)/websocket.xsb: /home/moddable/Projects/moddable/modules/network/websocket/websocket.js
	@echo "# xsc websocket.xsb"
	$(XSC) /home/moddable/Projects/moddable/modules/network/websocket/websocket.js -c -e -o $(@D) -r websocket
$(MODULES_DIR)/logical.xsb: /home/moddable/Projects/moddable/modules/data/logical/logical.js
	@echo "# xsc logical.xsb"
	$(XSC) /home/moddable/Projects/moddable/modules/data/logical/logical.js -c -e -o $(@D) -r logical
$(MODULES_DIR)/mqtt.xsb: /home/moddable/Projects/moddable/modules/network/mqtt/mqtt.js
	@echo "# xsc mqtt.xsb"
	$(XSC) /home/moddable/Projects/moddable/modules/network/mqtt/mqtt.js -c -e -o $(@D) -r mqtt
$(MODULES_DIR)/mqttserver.xsb: /home/moddable/Projects/moddable/modules/network/mqtt/mqttserver.js
	@echo "# xsc mqttserver.xsb"
	$(XSC) /home/moddable/Projects/moddable/modules/network/mqtt/mqttserver.js -c -e -o $(@D) -r mqttserver
$(MODULES_DIR)/flash.xsb: /home/moddable/Projects/moddable/modules/files/flash/flash.js
	@echo "# xsc flash.xsb"
	$(XSC) /home/moddable/Projects/moddable/modules/files/flash/flash.js -c -e -o $(@D) -r flash
$(MODULES_DIR)/setup/network.xsb: /home/moddable/Projects/moddable/build/devices/esp32/setup/network.js
	@echo "# xsc setup/network.xsb"
	$(XSC) /home/moddable/Projects/moddable/build/devices/esp32/setup/network.js -c -e -o $(@D) -r network
$(MODULES_DIR)/dns/parser.xsb: /home/moddable/Projects/moddable/modules/network/dns/dnsparser.js
	@echo "# xsc dns/parser.xsb"
	$(XSC) /home/moddable/Projects/moddable/modules/network/dns/dnsparser.js -c -e -o $(@D) -r parser
$(MODULES_DIR)/dns/serializer.xsb: /home/moddable/Projects/moddable/modules/network/dns/dnsserializer.js
	@echo "# xsc dns/serializer.xsb"
	$(XSC) /home/moddable/Projects/moddable/modules/network/dns/dnsserializer.js -c -e -o $(@D) -r serializer
$(MODULES_DIR)/ssl/alert.xsb: /home/moddable/Projects/moddable/modules/crypt/ssl/ssl_alert.js
	@echo "# xsc ssl/alert.xsb"
	$(XSC) /home/moddable/Projects/moddable/modules/crypt/ssl/ssl_alert.js -c -e -o $(@D) -r alert
$(MODULES_DIR)/ssl/cache.xsb: /home/moddable/Projects/moddable/modules/crypt/ssl/ssl_cache.js
	@echo "# xsc ssl/cache.xsb"
	$(XSC) /home/moddable/Projects/moddable/modules/crypt/ssl/ssl_cache.js -c -e -o $(@D) -r cache
$(MODULES_DIR)/ssl/cert.xsb: /home/moddable/Projects/moddable/modules/crypt/ssl/ssl_cert.js
	@echo "# xsc ssl/cert.xsb"
	$(XSC) /home/moddable/Projects/moddable/modules/crypt/ssl/ssl_cert.js -c -e -o $(@D) -r cert
$(MODULES_DIR)/ssl/changecipher.xsb: /home/moddable/Projects/moddable/modules/crypt/ssl/ssl_changecipher.js
	@echo "# xsc ssl/changecipher.xsb"
	$(XSC) /home/moddable/Projects/moddable/modules/crypt/ssl/ssl_changecipher.js -c -e -o $(@D) -r changecipher
$(MODULES_DIR)/ssl/ciphersuites.xsb: /home/moddable/Projects/moddable/modules/crypt/ssl/ssl_ciphersuites.js
	@echo "# xsc ssl/ciphersuites.xsb"
	$(XSC) /home/moddable/Projects/moddable/modules/crypt/ssl/ssl_ciphersuites.js -c -e -o $(@D) -r ciphersuites
$(MODULES_DIR)/ssl/constants.xsb: /home/moddable/Projects/moddable/modules/crypt/ssl/ssl_constants.js
	@echo "# xsc ssl/constants.xsb"
	$(XSC) /home/moddable/Projects/moddable/modules/crypt/ssl/ssl_constants.js -c -e -o $(@D) -r constants
$(MODULES_DIR)/ssl/handshake.xsb: /home/moddable/Projects/moddable/modules/crypt/ssl/ssl_handshake.js
	@echo "# xsc ssl/handshake.xsb"
	$(XSC) /home/moddable/Projects/moddable/modules/crypt/ssl/ssl_handshake.js -c -e -o $(@D) -r handshake
$(MODULES_DIR)/ssl/prf.xsb: /home/moddable/Projects/moddable/modules/crypt/ssl/ssl_prf.js
	@echo "# xsc ssl/prf.xsb"
	$(XSC) /home/moddable/Projects/moddable/modules/crypt/ssl/ssl_prf.js -c -e -o $(@D) -r prf
$(MODULES_DIR)/ssl/record.xsb: /home/moddable/Projects/moddable/modules/crypt/ssl/ssl_record.js
	@echo "# xsc ssl/record.xsb"
	$(XSC) /home/moddable/Projects/moddable/modules/crypt/ssl/ssl_record.js -c -e -o $(@D) -r record
$(MODULES_DIR)/ssl/session.xsb: /home/moddable/Projects/moddable/modules/crypt/ssl/ssl_session.js
	@echo "# xsc ssl/session.xsb"
	$(XSC) /home/moddable/Projects/moddable/modules/crypt/ssl/ssl_session.js -c -e -o $(@D) -r session
$(MODULES_DIR)/ssl/setup.xsb: /home/moddable/Projects/moddable/modules/crypt/ssl/ssl_setup.js
	@echo "# xsc ssl/setup.xsb"
	$(XSC) /home/moddable/Projects/moddable/modules/crypt/ssl/ssl_setup.js -c -e -o $(@D) -r setup
$(MODULES_DIR)/ssl/stream.xsb: /home/moddable/Projects/moddable/modules/crypt/ssl/ssl_stream.js
	@echo "# xsc ssl/stream.xsb"
	$(XSC) /home/moddable/Projects/moddable/modules/crypt/ssl/ssl_stream.js -c -e -o $(@D) -r stream
$(MODULES_DIR)/pins/analog.xsb: /home/moddable/Projects/moddable/modules/pins/analog/analog.js
	@echo "# xsc pins/analog.xsb"
	$(XSC) /home/moddable/Projects/moddable/modules/pins/analog/analog.js -c -e -o $(@D) -r analog
$(MODULES_DIR)/mc/config.xsb: /home/moddable/Projects/iot-product-dev-book/temp-monitor/host/tmp/esp32/instrument/host/mc.config.js
	@echo "# xsc mc/config.xsb"
	$(XSC) /home/moddable/Projects/iot-product-dev-book/temp-monitor/host/tmp/esp32/instrument/host/mc.config.js -c -e -o $(@D) -r config

$(TMP_DIR)/modTime.c.xsi: /home/moddable/Projects/moddable/modules/base/time/esp/modTime.c
	@echo "# xsid modTime.c.xsi"
	$(XSID) /home/moddable/Projects/moddable/modules/base/time/esp/modTime.c -o $(@D)
$(TMP_DIR)/modTimer.c.xsi: /home/moddable/Projects/moddable/modules/base/timer/modTimer.c
	@echo "# xsid modTimer.c.xsi"
	$(XSID) /home/moddable/Projects/moddable/modules/base/timer/modTimer.c -o $(@D)
$(TMP_DIR)/timer.c.xsi: /home/moddable/Projects/moddable/modules/base/timer/mc/timer.c
	@echo "# xsid timer.c.xsi"
	$(XSID) /home/moddable/Projects/moddable/modules/base/timer/mc/timer.c -o $(@D)
$(TMP_DIR)/Resource.c.xsi: /home/moddable/Projects/moddable/modules/files/resource/Resource.c
	@echo "# xsid Resource.c.xsi"
	$(XSID) /home/moddable/Projects/moddable/modules/files/resource/Resource.c -o $(@D)
$(TMP_DIR)/modInstrumentation.c.xsi: /home/moddable/Projects/moddable/modules/base/instrumentation/modInstrumentation.c
	@echo "# xsid modInstrumentation.c.xsi"
	$(XSID) /home/moddable/Projects/moddable/modules/base/instrumentation/modInstrumentation.c -o $(@D)
$(TMP_DIR)/modLwipSafe.c.xsi: /home/moddable/Projects/moddable/modules/network/socket/lwip/modLwipSafe.c
	@echo "# xsid modLwipSafe.c.xsi"
	$(XSID) /home/moddable/Projects/moddable/modules/network/socket/lwip/modLwipSafe.c -o $(@D)
$(TMP_DIR)/modSocket.c.xsi: /home/moddable/Projects/moddable/modules/network/socket/lwip/modSocket.c
	@echo "# xsid modSocket.c.xsi"
	$(XSID) /home/moddable/Projects/moddable/modules/network/socket/lwip/modSocket.c -o $(@D)
$(TMP_DIR)/modNet.c.xsi: /home/moddable/Projects/moddable/modules/network/net/esp/modNet.c
	@echo "# xsid modNet.c.xsi"
	$(XSID) /home/moddable/Projects/moddable/modules/network/net/esp/modNet.c -o $(@D)
$(TMP_DIR)/modResolve.c.xsi: /home/moddable/Projects/moddable/modules/network/net/esp/modResolve.c
	@echo "# xsid modResolve.c.xsi"
	$(XSID) /home/moddable/Projects/moddable/modules/network/net/esp/modResolve.c -o $(@D)
$(TMP_DIR)/modsntp.c.xsi: /home/moddable/Projects/moddable/modules/network/sntp/modsntp.c
	@echo "# xsid modsntp.c.xsi"
	$(XSID) /home/moddable/Projects/moddable/modules/network/sntp/modsntp.c -o $(@D)
$(TMP_DIR)/xs6wifi.c.xsi: /home/moddable/Projects/moddable/modules/network/wifi/esp32/xs6wifi.c
	@echo "# xsid xs6wifi.c.xsi"
	$(XSID) /home/moddable/Projects/moddable/modules/network/wifi/esp32/xs6wifi.c -o $(@D)
$(TMP_DIR)/moddnsparser.c.xsi: /home/moddable/Projects/moddable/modules/network/dns/moddnsparser.c
	@echo "# xsid moddnsparser.c.xsi"
	$(XSID) /home/moddable/Projects/moddable/modules/network/dns/moddnsparser.c -o $(@D)
$(TMP_DIR)/ec.c.xsi: /home/moddable/Projects/moddable/modules/crypt/arith/ec.c
	@echo "# xsid ec.c.xsi"
	$(XSID) /home/moddable/Projects/moddable/modules/crypt/arith/ec.c -o $(@D)
$(TMP_DIR)/modular.c.xsi: /home/moddable/Projects/moddable/modules/crypt/arith/modular.c
	@echo "# xsid modular.c.xsi"
	$(XSID) /home/moddable/Projects/moddable/modules/crypt/arith/modular.c -o $(@D)
$(TMP_DIR)/mont.c.xsi: /home/moddable/Projects/moddable/modules/crypt/arith/mont.c
	@echo "# xsid mont.c.xsi"
	$(XSID) /home/moddable/Projects/moddable/modules/crypt/arith/mont.c -o $(@D)
$(TMP_DIR)/xsBigIntEx.c.xsi: /home/moddable/Projects/moddable/modules/crypt/arith/xsBigIntEx.c
	@echo "# xsid xsBigIntEx.c.xsi"
	$(XSID) /home/moddable/Projects/moddable/modules/crypt/arith/xsBigIntEx.c -o $(@D)
$(TMP_DIR)/bin.c.xsi: /home/moddable/Projects/moddable/modules/crypt/bin/bin.c
	@echo "# xsid bin.c.xsi"
	$(XSID) /home/moddable/Projects/moddable/modules/crypt/bin/bin.c -o $(@D)
$(TMP_DIR)/modCrypt.c.xsi: /home/moddable/Projects/moddable/modules/crypt/digest/modCrypt.c
	@echo "# xsid modCrypt.c.xsi"
	$(XSID) /home/moddable/Projects/moddable/modules/crypt/digest/modCrypt.c -o $(@D)
$(TMP_DIR)/chacha.c.xsi: /home/moddable/Projects/moddable/modules/crypt/digest/kcl/chacha.c
	@echo "# xsid chacha.c.xsi"
	$(XSID) /home/moddable/Projects/moddable/modules/crypt/digest/kcl/chacha.c -o $(@D)
$(TMP_DIR)/fips180.c.xsi: /home/moddable/Projects/moddable/modules/crypt/digest/kcl/fips180.c
	@echo "# xsid fips180.c.xsi"
	$(XSID) /home/moddable/Projects/moddable/modules/crypt/digest/kcl/fips180.c -o $(@D)
$(TMP_DIR)/fips197.c.xsi: /home/moddable/Projects/moddable/modules/crypt/digest/kcl/fips197.c
	@echo "# xsid fips197.c.xsi"
	$(XSID) /home/moddable/Projects/moddable/modules/crypt/digest/kcl/fips197.c -o $(@D)
$(TMP_DIR)/fips46.c.xsi: /home/moddable/Projects/moddable/modules/crypt/digest/kcl/fips46.c
	@echo "# xsid fips46.c.xsi"
	$(XSID) /home/moddable/Projects/moddable/modules/crypt/digest/kcl/fips46.c -o $(@D)
$(TMP_DIR)/ghash.c.xsi: /home/moddable/Projects/moddable/modules/crypt/digest/kcl/ghash.c
	@echo "# xsid ghash.c.xsi"
	$(XSID) /home/moddable/Projects/moddable/modules/crypt/digest/kcl/ghash.c -o $(@D)
$(TMP_DIR)/rc.c.xsi: /home/moddable/Projects/moddable/modules/crypt/digest/kcl/rc.c
	@echo "# xsid rc.c.xsi"
	$(XSID) /home/moddable/Projects/moddable/modules/crypt/digest/kcl/rc.c -o $(@D)
$(TMP_DIR)/rfc1321.c.xsi: /home/moddable/Projects/moddable/modules/crypt/digest/kcl/rfc1321.c
	@echo "# xsid rfc1321.c.xsi"
	$(XSID) /home/moddable/Projects/moddable/modules/crypt/digest/kcl/rfc1321.c -o $(@D)
$(TMP_DIR)/rng.c.xsi: /home/moddable/Projects/moddable/modules/crypt/etc/rng.c
	@echo "# xsid rng.c.xsi"
	$(XSID) /home/moddable/Projects/moddable/modules/crypt/etc/rng.c -o $(@D)
$(TMP_DIR)/x509.c.xsi: /home/moddable/Projects/moddable/modules/crypt/etc/x509.c
	@echo "# xsid x509.c.xsi"
	$(XSID) /home/moddable/Projects/moddable/modules/crypt/etc/x509.c -o $(@D)
$(TMP_DIR)/modsecuresocket.c.xsi: /home/moddable/Projects/moddable/modules/crypt/securesocket/modsecuresocket.c
	@echo "# xsid modsecuresocket.c.xsi"
	$(XSID) /home/moddable/Projects/moddable/modules/crypt/securesocket/modsecuresocket.c -o $(@D)
$(TMP_DIR)/modBase64.c.xsi: /home/moddable/Projects/moddable/modules/data/base64/modBase64.c
	@echo "# xsid modBase64.c.xsi"
	$(XSID) /home/moddable/Projects/moddable/modules/data/base64/modBase64.c -o $(@D)
$(TMP_DIR)/modHex.c.xsi: /home/moddable/Projects/moddable/modules/data/hex/modHex.c
	@echo "# xsid modHex.c.xsi"
	$(XSID) /home/moddable/Projects/moddable/modules/data/hex/modHex.c -o $(@D)
$(TMP_DIR)/analog.c.xsi: /home/moddable/Projects/moddable/modules/pins/analog/esp32/analog.c
	@echo "# xsid analog.c.xsi"
	$(XSID) /home/moddable/Projects/moddable/modules/pins/analog/esp32/analog.c -o $(@D)
$(TMP_DIR)/modFile.c.xsi: /home/moddable/Projects/moddable/modules/files/file/esp32/modFile.c
	@echo "# xsid modFile.c.xsi"
	$(XSID) /home/moddable/Projects/moddable/modules/files/file/esp32/modFile.c -o $(@D)
$(TMP_DIR)/loadmod.c.xsi: /home/moddable/Projects/iot-product-dev-book/loadmod/loadmod.c
	@echo "# xsid loadmod.c.xsi"
	$(XSID) /home/moddable/Projects/iot-product-dev-book/loadmod/loadmod.c -o $(@D)
$(TMP_DIR)/modLogical.c.xsi: /home/moddable/Projects/moddable/modules/data/logical/modLogical.c
	@echo "# xsid modLogical.c.xsi"
	$(XSID) /home/moddable/Projects/moddable/modules/data/logical/modLogical.c -o $(@D)
$(TMP_DIR)/flash.c.xsi: /home/moddable/Projects/moddable/modules/files/flash/esp32/flash.c
	@echo "# xsid flash.c.xsi"
	$(XSID) /home/moddable/Projects/moddable/modules/files/flash/esp32/flash.c -o $(@D)
$(TMP_DIR)/modTimer.h.xsi: /home/moddable/Projects/moddable/modules/base/timer/modTimer.h
	@echo "# xsid modTimer.h.xsi"
	$(XSID) /home/moddable/Projects/moddable/modules/base/timer/modTimer.h -o $(@D)
$(TMP_DIR)/modInstrumentation.h.xsi: /home/moddable/Projects/moddable/modules/base/instrumentation/modInstrumentation.h
	@echo "# xsid modInstrumentation.h.xsi"
	$(XSID) /home/moddable/Projects/moddable/modules/base/instrumentation/modInstrumentation.h -o $(@D)
$(TMP_DIR)/modLwipSafe.h.xsi: /home/moddable/Projects/moddable/modules/network/socket/lwip/modLwipSafe.h
	@echo "# xsid modLwipSafe.h.xsi"
	$(XSID) /home/moddable/Projects/moddable/modules/network/socket/lwip/modLwipSafe.h -o $(@D)
$(TMP_DIR)/modSocket.h.xsi: /home/moddable/Projects/moddable/modules/network/socket/modSocket.h
	@echo "# xsid modSocket.h.xsi"
	$(XSID) /home/moddable/Projects/moddable/modules/network/socket/modSocket.h -o $(@D)
$(TMP_DIR)/xsBigIntEx.h.xsi: /home/moddable/Projects/moddable/modules/crypt/arith/xsBigIntEx.h
	@echo "# xsid xsBigIntEx.h.xsi"
	$(XSID) /home/moddable/Projects/moddable/modules/crypt/arith/xsBigIntEx.h -o $(@D)
$(TMP_DIR)/chacha.h.xsi: /home/moddable/Projects/moddable/modules/crypt/digest/kcl/chacha.h
	@echo "# xsid chacha.h.xsi"
	$(XSID) /home/moddable/Projects/moddable/modules/crypt/digest/kcl/chacha.h -o $(@D)
$(TMP_DIR)/fips180.h.xsi: /home/moddable/Projects/moddable/modules/crypt/digest/kcl/fips180.h
	@echo "# xsid fips180.h.xsi"
	$(XSID) /home/moddable/Projects/moddable/modules/crypt/digest/kcl/fips180.h -o $(@D)
$(TMP_DIR)/fips197.h.xsi: /home/moddable/Projects/moddable/modules/crypt/digest/kcl/fips197.h
	@echo "# xsid fips197.h.xsi"
	$(XSID) /home/moddable/Projects/moddable/modules/crypt/digest/kcl/fips197.h -o $(@D)
$(TMP_DIR)/fips46.h.xsi: /home/moddable/Projects/moddable/modules/crypt/digest/kcl/fips46.h
	@echo "# xsid fips46.h.xsi"
	$(XSID) /home/moddable/Projects/moddable/modules/crypt/digest/kcl/fips46.h -o $(@D)
$(TMP_DIR)/ghash.h.xsi: /home/moddable/Projects/moddable/modules/crypt/digest/kcl/ghash.h
	@echo "# xsid ghash.h.xsi"
	$(XSID) /home/moddable/Projects/moddable/modules/crypt/digest/kcl/ghash.h -o $(@D)
$(TMP_DIR)/kcl.h.xsi: /home/moddable/Projects/moddable/modules/crypt/digest/kcl/kcl.h
	@echo "# xsid kcl.h.xsi"
	$(XSID) /home/moddable/Projects/moddable/modules/crypt/digest/kcl/kcl.h -o $(@D)
$(TMP_DIR)/kcl_symmetric.h.xsi: /home/moddable/Projects/moddable/modules/crypt/digest/kcl/kcl_symmetric.h
	@echo "# xsid kcl_symmetric.h.xsi"
	$(XSID) /home/moddable/Projects/moddable/modules/crypt/digest/kcl/kcl_symmetric.h -o $(@D)
$(TMP_DIR)/rc.h.xsi: /home/moddable/Projects/moddable/modules/crypt/digest/kcl/rc.h
	@echo "# xsid rc.h.xsi"
	$(XSID) /home/moddable/Projects/moddable/modules/crypt/digest/kcl/rc.h -o $(@D)
$(TMP_DIR)/rfc1321.h.xsi: /home/moddable/Projects/moddable/modules/crypt/digest/kcl/rfc1321.h
	@echo "# xsid rfc1321.h.xsi"
	$(XSID) /home/moddable/Projects/moddable/modules/crypt/digest/kcl/rfc1321.h -o $(@D)

$(TMP_DIR)/modTime.c.o: /home/moddable/Projects/moddable/modules/base/time/esp/modTime.c $(HEADERS) | $(TMP_DIR)/mc.xs.c
	@echo "# cc modTime.c.o"
	$(CC) $(C_DEFINES) $(C_INCLUDES) $(C_FLAGS) $< -o $@
$(TMP_DIR)/modTimer.c.o: /home/moddable/Projects/moddable/modules/base/timer/modTimer.c $(HEADERS) | $(TMP_DIR)/mc.xs.c
	@echo "# cc modTimer.c.o"
	$(CC) $(C_DEFINES) $(C_INCLUDES) $(C_FLAGS) $< -o $@
$(TMP_DIR)/timer.c.o: /home/moddable/Projects/moddable/modules/base/timer/mc/timer.c $(HEADERS) | $(TMP_DIR)/mc.xs.c
	@echo "# cc timer.c.o"
	$(CC) $(C_DEFINES) $(C_INCLUDES) $(C_FLAGS) $< -o $@
$(TMP_DIR)/Resource.c.o: /home/moddable/Projects/moddable/modules/files/resource/Resource.c $(HEADERS) | $(TMP_DIR)/mc.xs.c
	@echo "# cc Resource.c.o"
	$(CC) $(C_DEFINES) $(C_INCLUDES) $(C_FLAGS) $< -o $@
$(TMP_DIR)/modInstrumentation.c.o: /home/moddable/Projects/moddable/modules/base/instrumentation/modInstrumentation.c $(HEADERS) | $(TMP_DIR)/mc.xs.c
	@echo "# cc modInstrumentation.c.o"
	$(CC) $(C_DEFINES) $(C_INCLUDES) $(C_FLAGS) $< -o $@
$(TMP_DIR)/modLwipSafe.c.o: /home/moddable/Projects/moddable/modules/network/socket/lwip/modLwipSafe.c $(HEADERS) | $(TMP_DIR)/mc.xs.c
	@echo "# cc modLwipSafe.c.o"
	$(CC) $(C_DEFINES) $(C_INCLUDES) $(C_FLAGS) $< -o $@
$(TMP_DIR)/modSocket.c.o: /home/moddable/Projects/moddable/modules/network/socket/lwip/modSocket.c $(HEADERS) | $(TMP_DIR)/mc.xs.c
	@echo "# cc modSocket.c.o"
	$(CC) $(C_DEFINES) $(C_INCLUDES) $(C_FLAGS) $< -o $@
$(TMP_DIR)/modNet.c.o: /home/moddable/Projects/moddable/modules/network/net/esp/modNet.c $(HEADERS) | $(TMP_DIR)/mc.xs.c
	@echo "# cc modNet.c.o"
	$(CC) $(C_DEFINES) $(C_INCLUDES) $(C_FLAGS) $< -o $@
$(TMP_DIR)/modResolve.c.o: /home/moddable/Projects/moddable/modules/network/net/esp/modResolve.c $(HEADERS) | $(TMP_DIR)/mc.xs.c
	@echo "# cc modResolve.c.o"
	$(CC) $(C_DEFINES) $(C_INCLUDES) $(C_FLAGS) $< -o $@
$(TMP_DIR)/modsntp.c.o: /home/moddable/Projects/moddable/modules/network/sntp/modsntp.c $(HEADERS) | $(TMP_DIR)/mc.xs.c
	@echo "# cc modsntp.c.o"
	$(CC) $(C_DEFINES) $(C_INCLUDES) $(C_FLAGS) $< -o $@
$(TMP_DIR)/xs6wifi.c.o: /home/moddable/Projects/moddable/modules/network/wifi/esp32/xs6wifi.c $(HEADERS) | $(TMP_DIR)/mc.xs.c
	@echo "# cc xs6wifi.c.o"
	$(CC) $(C_DEFINES) $(C_INCLUDES) $(C_FLAGS) $< -o $@
$(TMP_DIR)/moddnsparser.c.o: /home/moddable/Projects/moddable/modules/network/dns/moddnsparser.c $(HEADERS) | $(TMP_DIR)/mc.xs.c
	@echo "# cc moddnsparser.c.o"
	$(CC) $(C_DEFINES) $(C_INCLUDES) $(C_FLAGS) $< -o $@
$(TMP_DIR)/ec.c.o: /home/moddable/Projects/moddable/modules/crypt/arith/ec.c $(HEADERS) | $(TMP_DIR)/mc.xs.c
	@echo "# cc ec.c.o"
	$(CC) $(C_DEFINES) $(C_INCLUDES) $(C_FLAGS) $< -o $@
$(TMP_DIR)/modular.c.o: /home/moddable/Projects/moddable/modules/crypt/arith/modular.c $(HEADERS) | $(TMP_DIR)/mc.xs.c
	@echo "# cc modular.c.o"
	$(CC) $(C_DEFINES) $(C_INCLUDES) $(C_FLAGS) $< -o $@
$(TMP_DIR)/mont.c.o: /home/moddable/Projects/moddable/modules/crypt/arith/mont.c $(HEADERS) | $(TMP_DIR)/mc.xs.c
	@echo "# cc mont.c.o"
	$(CC) $(C_DEFINES) $(C_INCLUDES) $(C_FLAGS) $< -o $@
$(TMP_DIR)/xsBigIntEx.c.o: /home/moddable/Projects/moddable/modules/crypt/arith/xsBigIntEx.c $(HEADERS) | $(TMP_DIR)/mc.xs.c
	@echo "# cc xsBigIntEx.c.o"
	$(CC) $(C_DEFINES) $(C_INCLUDES) $(C_FLAGS) $< -o $@
$(TMP_DIR)/bin.c.o: /home/moddable/Projects/moddable/modules/crypt/bin/bin.c $(HEADERS) | $(TMP_DIR)/mc.xs.c
	@echo "# cc bin.c.o"
	$(CC) $(C_DEFINES) $(C_INCLUDES) $(C_FLAGS) $< -o $@
$(TMP_DIR)/modCrypt.c.o: /home/moddable/Projects/moddable/modules/crypt/digest/modCrypt.c $(HEADERS) | $(TMP_DIR)/mc.xs.c
	@echo "# cc modCrypt.c.o"
	$(CC) $(C_DEFINES) $(C_INCLUDES) $(C_FLAGS) $< -o $@
$(TMP_DIR)/chacha.c.o: /home/moddable/Projects/moddable/modules/crypt/digest/kcl/chacha.c $(HEADERS) | $(TMP_DIR)/mc.xs.c
	@echo "# cc chacha.c.o"
	$(CC) $(C_DEFINES) $(C_INCLUDES) $(C_FLAGS) $< -o $@
$(TMP_DIR)/fips180.c.o: /home/moddable/Projects/moddable/modules/crypt/digest/kcl/fips180.c $(HEADERS) | $(TMP_DIR)/mc.xs.c
	@echo "# cc fips180.c.o"
	$(CC) $(C_DEFINES) $(C_INCLUDES) $(C_FLAGS) $< -o $@
$(TMP_DIR)/fips197.c.o: /home/moddable/Projects/moddable/modules/crypt/digest/kcl/fips197.c $(HEADERS) | $(TMP_DIR)/mc.xs.c
	@echo "# cc fips197.c.o"
	$(CC) $(C_DEFINES) $(C_INCLUDES) $(C_FLAGS) $< -o $@
$(TMP_DIR)/fips46.c.o: /home/moddable/Projects/moddable/modules/crypt/digest/kcl/fips46.c $(HEADERS) | $(TMP_DIR)/mc.xs.c
	@echo "# cc fips46.c.o"
	$(CC) $(C_DEFINES) $(C_INCLUDES) $(C_FLAGS) $< -o $@
$(TMP_DIR)/ghash.c.o: /home/moddable/Projects/moddable/modules/crypt/digest/kcl/ghash.c $(HEADERS) | $(TMP_DIR)/mc.xs.c
	@echo "# cc ghash.c.o"
	$(CC) $(C_DEFINES) $(C_INCLUDES) $(C_FLAGS) $< -o $@
$(TMP_DIR)/rc.c.o: /home/moddable/Projects/moddable/modules/crypt/digest/kcl/rc.c $(HEADERS) | $(TMP_DIR)/mc.xs.c
	@echo "# cc rc.c.o"
	$(CC) $(C_DEFINES) $(C_INCLUDES) $(C_FLAGS) $< -o $@
$(TMP_DIR)/rfc1321.c.o: /home/moddable/Projects/moddable/modules/crypt/digest/kcl/rfc1321.c $(HEADERS) | $(TMP_DIR)/mc.xs.c
	@echo "# cc rfc1321.c.o"
	$(CC) $(C_DEFINES) $(C_INCLUDES) $(C_FLAGS) $< -o $@
$(TMP_DIR)/rng.c.o: /home/moddable/Projects/moddable/modules/crypt/etc/rng.c $(HEADERS) | $(TMP_DIR)/mc.xs.c
	@echo "# cc rng.c.o"
	$(CC) $(C_DEFINES) $(C_INCLUDES) $(C_FLAGS) $< -o $@
$(TMP_DIR)/x509.c.o: /home/moddable/Projects/moddable/modules/crypt/etc/x509.c $(HEADERS) | $(TMP_DIR)/mc.xs.c
	@echo "# cc x509.c.o"
	$(CC) $(C_DEFINES) $(C_INCLUDES) $(C_FLAGS) $< -o $@
$(TMP_DIR)/modsecuresocket.c.o: /home/moddable/Projects/moddable/modules/crypt/securesocket/modsecuresocket.c $(HEADERS) | $(TMP_DIR)/mc.xs.c
	@echo "# cc modsecuresocket.c.o"
	$(CC) $(C_DEFINES) $(C_INCLUDES) $(C_FLAGS) $< -o $@
$(TMP_DIR)/modBase64.c.o: /home/moddable/Projects/moddable/modules/data/base64/modBase64.c $(HEADERS) | $(TMP_DIR)/mc.xs.c
	@echo "# cc modBase64.c.o"
	$(CC) $(C_DEFINES) $(C_INCLUDES) $(C_FLAGS) $< -o $@
$(TMP_DIR)/modHex.c.o: /home/moddable/Projects/moddable/modules/data/hex/modHex.c $(HEADERS) | $(TMP_DIR)/mc.xs.c
	@echo "# cc modHex.c.o"
	$(CC) $(C_DEFINES) $(C_INCLUDES) $(C_FLAGS) $< -o $@
$(TMP_DIR)/analog.c.o: /home/moddable/Projects/moddable/modules/pins/analog/esp32/analog.c $(HEADERS) | $(TMP_DIR)/mc.xs.c
	@echo "# cc analog.c.o"
	$(CC) $(C_DEFINES) $(C_INCLUDES) $(C_FLAGS) $< -o $@
$(TMP_DIR)/modFile.c.o: /home/moddable/Projects/moddable/modules/files/file/esp32/modFile.c $(HEADERS) | $(TMP_DIR)/mc.xs.c
	@echo "# cc modFile.c.o"
	$(CC) $(C_DEFINES) $(C_INCLUDES) $(C_FLAGS) $< -o $@
$(TMP_DIR)/loadmod.c.o: /home/moddable/Projects/iot-product-dev-book/loadmod/loadmod.c $(HEADERS) | $(TMP_DIR)/mc.xs.c
	@echo "# cc loadmod.c.o"
	$(CC) $(C_DEFINES) $(C_INCLUDES) $(C_FLAGS) $< -o $@
$(TMP_DIR)/modLogical.c.o: /home/moddable/Projects/moddable/modules/data/logical/modLogical.c $(HEADERS) | $(TMP_DIR)/mc.xs.c
	@echo "# cc modLogical.c.o"
	$(CC) $(C_DEFINES) $(C_INCLUDES) $(C_FLAGS) $< -o $@
$(TMP_DIR)/flash.c.o: /home/moddable/Projects/moddable/modules/files/flash/esp32/flash.c $(HEADERS) | $(TMP_DIR)/mc.xs.c
	@echo "# cc flash.c.o"
	$(CC) $(C_DEFINES) $(C_INCLUDES) $(C_FLAGS) $< -o $@

$(TMP_DIR)/mc.bleservices:
	$(BLES2GATT) -s /home/moddable/Projects/moddable/build/devices/esp32/xsProj/sdkconfig.mc -o $(TMP_DIR)

$(RESOURCES_DIR)/ca.ski: /home/moddable/Projects/moddable/modules/crypt/data/ca.ski
	@echo "# copy ca.ski"
	cp $< $@
$(RESOURCES_DIR)/ca.subject: /home/moddable/Projects/moddable/modules/crypt/data/ca.subject
	@echo "# copy ca.subject"
	cp $< $@
$(RESOURCES_DIR)/locals.mhi: $(HEADERS)
	@echo "# mclocal strings"
	$(MCLOCAL) -d -s -o $(@D)

